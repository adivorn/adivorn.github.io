<script>
const now = new Date();
const tahunSekarang = now.getFullYear();

function isi(id, start, end, placeholder=false) {
  const el = document.getElementById(id);
  if (!placeholder) el.innerHTML = "";
  for (let i = start; i <= end; i++) {
    el.innerHTML += `<option value="${i}">${i}</option>`;
  }
}

// tanggal lahir
isi("d1",1,31,true);
isi("m1",1,12,true);
isi("y1",1950,tahunSekarang,true);

// target otomatis hari ini
isi("d2",1,31);
isi("m2",1,12);
isi("y2",1950,tahunSekarang);

document.getElementById("d2").value = now.getDate();
document.getElementById("m2").value = now.getMonth() + 1;
document.getElementById("y2").value = tahunSekarang;

function hitungUsia() {
  const d1 = Number(document.getElementById("d1").value);
  const m1 = Number(document.getElementById("m1").value);
  const y1 = Number(document.getElementById("y1").value);

  if (!d1 || !m1 || !y1) {
    document.getElementById("hasil").innerText = "Lengkapi tanggal lahir!";
    return;
  }

  const d2 = Number(document.getElementById("d2").value);
  const m2 = Number(document.getElementById("m2").value);
  const y2 = Number(document.getElementById("y2").value);

  const lahir = new Date(y1, m1 - 1, d1);
  const target = new Date(y2, m2 - 1, d2);

  if (target < lahir) {
    document.getElementById("hasil").innerText = "Tanggal target lebih awal dari lahir!";
    return;
  }

  let tahun = y2 - y1;
  let bulan = m2 - m1;
  let hari = d2 - d1;

  if (hari < 0) {
    bulan--;
    hari += new Date(y2, m2 - 1, 0).getDate();
  }
  if (bulan < 0) {
    tahun--;
    bulan += 12;
  }

  const diffMs = target - lahir;
  const totalHari = Math.floor(diffMs / (1000 * 60 * 60 * 24));
  const totalJam = Math.floor(diffMs / (1000 * 60 * 60));
  const totalMinggu = Math.floor(totalHari / 7);
  const totalBulan = tahun * 12 + bulan;

  document.getElementById("hasil").innerHTML = `
    <div class="big">${tahun} tahun ${bulan} bulan ${hari} hari</div><br>
    kamu telah hidup:<br>
    dalam tahun: ${tahun}<br>
    dalam bulan: ${totalBulan}<br>
    dalam minggu: ${totalMinggu}<br>
    dalam hari: ${totalHari}<br>
    dalam jam: ${totalJam}
  `;
}
</script>
